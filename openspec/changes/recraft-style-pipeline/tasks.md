## /note 기록 규칙

> Phase 완료 시, 중요 발견 시, 최종 보고서 시 `/note` 기록.
> 구체적 수치 + 의사결정 과정 포함.

---

## 0. 레퍼런스 수집 + 스타일 적합도 평가

### 0-A. 레퍼런스 수집 (사람)

- [ ] 0.1 원하는 톤의 레퍼런스 에셋 5~10장 수집
  - Kurzgesagt 영상 프레임, 외부 아이콘, 기존 실험 결과 중 마음에 드는 것
  - 형식 무관 (PNG, SVG, 스크린샷 등)
  - `experiment/reference/collected/` 에 저장
- [ ] 0.2 수집 의도 메모: "이 에셋들에서 가져오고 싶은 것"을 자유 텍스트로 기록
  - 예: "이 글로우 느낌", "이 색감", "이 단순함의 정도"

### 0-B. 스타일 적합도 평가 (AI)

- [ ] 0.3 수집된 레퍼런스 세트를 Claude Vision으로 분석
  - **내적 일관성**: 에셋끼리 같은 세계관으로 보이는가?
  - **생성 적합도**: 이 스타일을 Recraft API로 재현 가능한가?
  - **구체성**: 스타일이 충분히 구체적인가, 너무 모호한가?
- [ ] 0.4 적합도 리포트 산출

```
스타일 적합도 평가:
  수집 에셋 수: ___장
  내적 일관성: 높음 / 보통 / 낮음 (사유: ___)
  생성 적합도: 높음 / 보통 / 낮음 (사유: ___)
  구체성:      높음 / 보통 / 낮음 (사유: ___)

  ★ 종합 판정: 진행 / 에셋 보강 필요 / 에셋 교체 필요
  ★ 권장 조치: ___
```

- [ ] 0.5 판정이 "에셋 보강/교체 필요"면 → 사람이 에셋 조정 후 0.3부터 반복

---

## 1. 트라이얼 생성 + 사람 검수 (핵심 게이트)

### 1-A. 스타일 등록 + 트라이얼

- [ ] 1.1 수집된 레퍼런스로 Recraft create_style 호출 → style_id 획득
- [ ] 1.2 style_id로 트라이얼 아이콘 5장 생성 (대표 카테고리별 1장씩)
  - 금화, 차트, 저금통, 화살표, 전구
  - 결과: `experiment/outputs/trial/`
- [ ] 1.3 배경 통제 확인 — 안 되면 remove_background + replace_background 후처리

### 1-B. 사람 검수 (Gate)

- [ ] 1.4 **사람이 트라이얼 5장 검수**
  - 각 아이콘: 승인 ✅ / 거부 ❌ + 피드백
  - 피드백 예시: "글로우가 부족", "너무 복잡", "색감이 탁함"
- [ ] 1.5 **Gate 판정**:
  - 승인 3장↑ → Phase 2 진행
  - 승인 2장↓ → 레퍼런스 조정 또는 substyle 변경 후 1.1부터 반복

```
트라이얼 결과:
  style_id: ___
  | 아이콘    | 판정 | 피드백            |
  |----------|------|------------------|
  | 금화      |      |                  |
  | 차트      |      |                  |
  | 저금통    |      |                  |
  | 화살표    |      |                  |
  | 전구      |      |                  |

  승인: ___/5
  ★ Gate 판정: 진행 / 재시도
  ★ 반복 횟수: ___
```

---

## 2. 채점 캘리브레이션

- [ ] 2.1 **승인된 트라이얼을 "골드 스탠다드"로 지정**
  - 승인된 아이콘들 → `experiment/reference/gold-standard/`
- [ ] 2.2 Claude Vision으로 골드 스탠다드 분석 → 스타일 특성 추출
  - 형태 언어, 색상 운용, 글로우/광원, 질감, 복잡도
  - 결과: `experiment/reference/style-profile.md`
- [ ] 2.3 **채점 프롬프트 생성**: 골드 스탠다드를 레퍼런스 이미지로 첨부한 채점 프롬프트
  - "이 레퍼런스와 얼마나 같은 느낌인가?" — 단일 축 10점 척도
  - 보조 항목: 배경 적합성, 아이콘 식별성 (각 Pass/Fail)
- [ ] 2.4 **캘리브레이션 검증**: 승인된 아이콘을 채점 → 8/10↑ 나오는지 확인
  - 안 나오면 프롬프트 조정 후 재검증
  - 거부된 아이콘도 채점 → 확실히 낮은 점수가 나오는지 확인 (역검증)

```
캘리브레이션 결과:
  골드 스탠다드: ___장
  style-profile.md 작성: ___

  채점 검증:
  | 아이콘       | 사람 판정 | AI 점수 | 일치 |
  |-------------|---------|--------|------|
  | (승인된 것)   | ✅      | ___/10 |      |
  | (승인된 것)   | ✅      | ___/10 |      |
  | (거부된 것)   | ❌      | ___/10 |      |

  ★ AI-사람 일치도: ___
  ★ 합격 기준선: ___/10
```

---

## 3. 배치 생성 + 자동 QA 루프

- [ ] 3.1 prompts-production.ts의 30종 아이콘 정의 재사용
- [ ] 3.2 style_id + style-profile.md 핵심 요소 병기하여 30개 배치 생성
- [ ] 3.3 배경 후처리 필요 시 일괄 적용
- [ ] 3.4 **자동 QA**: 캘리브레이션된 채점 프롬프트로 30개 전량 채점
  - 골드 스탠다드 이미지를 레퍼런스로 첨부
  - 스타일 일치도 (___/10) + 배경 적합성 (P/F) + 아이콘 식별성 (P/F)
- [ ] 3.5 **자동 재생성 루프**:
  - 기준 미달 아이콘 → 프롬프트 미세 조정 → 재생성 → 재채점
  - 최대 2회 재시도. 2회 실패 시 사람 판단으로 넘김
- [ ] 3.6 batch-log.json 기록

```
배치 결과:
  생성: ___개
  1차 통과: ___개 (___%)
  재생성 후 통과: ___개
  사람 판단 필요: ___개
  크레딧 사용: ___
```

---

## 4. 최종 사람 검수

- [ ] 4.1 자동 QA 통과 아이콘 전체를 한눈에 펼쳐서 사람 검수
  - 개별 품질 + 세트 일관성 동시 확인
- [ ] 4.2 부적합 아이콘 표시 → 재생성 또는 제외
- [ ] 4.3 **일관성 체크**: 전체를 나란히 놓았을 때 "한 세트로 보이는가?"
  - 튀는 아이콘 있으면 재생성
- [ ] 4.4 최종 production 세트 확정 → `outputs/production-recraft/`
- [ ] 4.5 (선택) 사람 검수에서 AI 점수와 불일치한 케이스 → 채점 프롬프트 보정
  - 다음 배치에서 정확도 개선

```
최종 결과:
  최종 production 확보: ___개
  목표 대비: ___/25 (목표 25개↑)
  AI-사람 판정 일치율: ___% (캘리브레이션 정확도)
  ★ production 적합 판정: ___
```

---

## 5. 비교 보고 + 파이프라인 확정

- [ ] 5.1 Claude SVG vs Recraft 나란히 비교 (동일 아이콘)
- [ ] 5.2 파이프라인 유효성 판정
- [ ] 5.3 /note 최종 기록

```
최종 비교:
  | 기준          | Claude SVG | Recraft (style_id) |
  |--------------|-----------|-------------------|
  | 시각 품질      | _/10     | _/10              |
  | 일관성        | _/10     | _/10              |
  | 비용          | $___     | $___              |
  | production 적합 | _/10   | _/10              |

  ★ 최종 권장 파이프라인: ___
```

---

## 성공 기준

| 기준 | 목표 | Phase |
|------|------|-------|
| 스타일 적합도 평가 | "진행" 판정 | 0 |
| 트라이얼 사람 승인 | 3/5↑ | 1 |
| 캘리브레이션 AI-사람 일치 | 승인=8/10↑, 거부=낮은 점수 | 2 |
| 자동 QA 1차 통과율 | 60%↑ | 3 |
| 최종 production 확보 | 25개↑ | 4 |

---

## 핵심 원칙

1. **사람 판단이 먼저, AI 평가는 그 다음** — Phase 1에서 사람이 승인한 것이 모든 자동 평가의 기준이 됨
2. **빠른 피드백 루프** — 30개 배치 전에 5장으로 방향 확인
3. **채점 = 캘리브레이션** — 임의 기준이 아니라 사람 승인에서 역산된 기준
4. **단순하게** — 점수 체계 1개 (스타일 일치도 10점), 보조 2개 (P/F)
